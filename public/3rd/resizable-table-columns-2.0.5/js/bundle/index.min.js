!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).validide_resizableTableColumns={})}(this,function(e){"use strict";var f=(t.dataPropertyName="validide_rtc_data_object",t.classes={table:"rtc-table",wrapper:"rtc-wrapper",handleContainer:"rtc-handle-container",handle:"rtc-handle",tableResizing:"rtc-table-resizing",columnResizing:"rtc-column-resizing"},t.attributes={dataResizable:"data-rtc-resizable",dataResizableTable:"data-rtc-resizable-table"},t.data={resizable:"rtcResizable",resizableTable:"rtcResizableTable"},t.events={pointerDown:["mousedown","touchstart"],pointerMove:["mousemove","touchmove"],pointerUp:["mouseup","touchend"],windowResize:["resize"],eventResizeStart:"eventResizeStart.rtc",eventResize:"eventResize.rtc",eventResizeStop:"eventResizeStop.rtc"},t);function t(){}var i=function(){this.column=0,this.table=0},n=function(){this.x=null,this.isDoubleClick=!1},l=function(e,t){this.pointer=new n,this.originalWidths=new i,this.newWidths=new i,this.column=e,this.dragHandler=t},a=(s.kebabCaseToCamelCase=function(e){return e.replace(s.kebabCaseRegex,function(e){return e[1].toUpperCase()})},s.parseStringToType=function(e){if(0==e.length||s.onlyWhiteSpace.test(e))return e;if(s.trueRegex.test(e))return!0;if(s.falseRegex.test(e))return!1;if(s.notEmptyOrWhiteSpace.test(e)){var t=+e;if(!isNaN(t))return t}return e},s.regexEscapeRegex=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,s.kebabCaseRegex=/(\-\w)/g,s.trueRegex=/^true$/i,s.falseRegex=/^false$/i,s.onlyWhiteSpace=/^\s$/,s.notEmptyOrWhiteSpace=/\S/,s);function s(){}var o=(r.getDataAttributesValues=function(e){if(!e)return null;var t={};if(e.dataset)for(var i in e.dataset)e.dataset.hasOwnProperty(i)&&(t[i]=a.parseStringToType(e.dataset[i]||""));else for(var n=0;n<e.attributes.length;n++)/^data\-/.test(e.attributes[n].name)&&(t[a.kebabCaseToCamelCase(e.attributes[n].name.replace("data-",""))]=a.parseStringToType(e.attributes[n].value));return t},r);function r(){}var h=(d.prototype.overrideValues=function(e){if(e=void 0===e?null:e)for(var t in e)this.hasOwnProperty(t)&&(this[t]=e[t])},d.prototype.overrideValuesFromElement=function(e){(e=void 0===e?null:e)&&(e=o.getDataAttributesValues(e),this.overrideValues(e))},d);function d(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.resizeFromBody=!0,this.minWidth=40,this.maxWidth=null,this.doubleClickDelay=500,this.maxInitialWidthHint=null,this.store=null,this.overrideValues(e),this.overrideValuesFromElement(t)}var u=(b.prototype.init=function(){this.validateMarkup(),this.createHandlerReferences(),this.wrapTable(),this.assignTableHeaders(),this.storeOriginalWidths(),this.setHeaderWidths(),this.createDragHandles(),this.restoreColumnWidths(),this.checkTableWidth(),this.syncHandleWidths(),this.registerWindowResizeHandler()},b.prototype.dispose=function(){this.destroyDragHandles(),this.restoreOriginalWidths(),this.unwrapTable(),this.onPointerDownRef=null,this.onPointerMoveRef=null,this.onPointerUpRef=null,this.table[f.dataPropertyName]=void 0},b.prototype.validateMarkup=function(){for(var e=0,t=0,i=null,n=0;n<this.table.childNodes.length;n++)"THEAD"===(o=this.table.childNodes[n]).nodeName?(e++,i=o):"TBODY"===o.nodeName&&t++;if(null===i||1!==e)throw"Markup validation: thead count.\nResizableTableColumns requires that the table element has one(1) table head element. Current count: "+e;if(1!==t)throw"Markup validation: tbody count.\nResizableTableColumns requires that the table element has one(1) table body element. Current count: "+t;for(var a=0,s=null,n=0;n<i.childNodes.length;n++)"TR"===(o=i.childNodes[n]).nodeName&&(a++,null===s&&(s=o));if(null===s||a<1)throw"Markup validation: thead row count.\nResizableTableColumns requires that the table head element has at least one(1) table row element. Current count: "+a;for(var o,r=0,l=0,n=0;n<s.childNodes.length;n++)"TH"===(o=s.childNodes[n]).nodeName?r++:"TD"===o.nodeName&&l++;if(r<1)throw"Markup validation: thead first row cells count.\nResizableTableColumns requires that the table head's first row element has at least one(1) table header cell element. Current count: "+r;if(0!==l)throw"Markup validation: thead first row invalid.\nResizableTableColumns requires that the table head's first row element has no(0) table cell(TD) elements. Current count: "+l},b.prototype.wrapTable=function(){var e;this.wrapper||(this.wrapper=this.ownerDocument.createElement("div"),this.wrapper.classList.add(f.classes.wrapper),(e=this.table.parentNode).insertBefore(this.wrapper,this.table),e.removeChild(this.table),this.wrapper.appendChild(this.table),this.table.classList.add(f.classes.table))},b.prototype.unwrapTable=function(){var e;this.table.classList.remove(f.classes.table),this.wrapper&&((e=this.wrapper.parentNode).insertBefore(this.table,this.wrapper),e.removeChild(this.wrapper),this.wrapper=null)},b.prototype.assignTableHeaders=function(){for(var e,t,i=0;i<this.table.childNodes.length;i++)if("THEAD"===(n=this.table.childNodes[i]).nodeName){e=n;break}if(e){for(i=0;i<e.childNodes.length;i++)if("TR"===(n=e.childNodes[i]).nodeName){t=n;break}if(t)for(var n,i=0;i<t.childNodes.length;i++)"TH"===(n=t.childNodes[i]).nodeName&&this.tableHeaders.push(n)}},b.prototype.storeOriginalWidths=function(){var t=this;this.tableHeaders.forEach(function(e){t.originalWidths.push({el:e,detail:e.style.width})}),this.originalWidths.push({el:this.table,detail:this.table.style.width})},b.prototype.restoreOriginalWidths=function(){this.originalWidths.forEach(function(e){e.el.style.width=e.detail})},b.prototype.setHeaderWidths=function(){var i=this;this.tableHeaders.forEach(function(e){var t=e.offsetWidth,t=i.constrainWidth(e,t);"number"==typeof i.options.maxInitialWidthHint&&(t=Math.min(t,i.options.maxInitialWidthHint)),i.updateWidth(e,t,!0,!1)})},b.prototype.constrainWidth=function(e,t){var i=Math.max(t,this.options.minWidth||-1/0);return Math.min(i,this.options.maxWidth||1/0)},b.prototype.createDragHandles=function(){var e,n=this;if(null!=this.dragHandlesContainer)throw"Drag handlers already created. Call <destroyDragHandles> if you wish to recreate them";this.dragHandlesContainer=this.ownerDocument.createElement("div"),null!==(e=this.wrapper)&&void 0!==e&&e.insertBefore(this.dragHandlesContainer,this.table),this.dragHandlesContainer.classList.add(f.classes.handleContainer),this.getResizableHeaders().forEach(function(){var e,t=n.ownerDocument.createElement("div");t.classList.add(f.classes.handle),null!==(e=n.dragHandlesContainer)&&void 0!==e&&e.appendChild(t)}),f.events.pointerDown.forEach(function(e,t){var i;null!==(i=n.dragHandlesContainer)&&void 0!==i&&i.addEventListener(e,n.onPointerDownRef,!1)})},b.prototype.destroyDragHandles=function(){var e,n=this;null!==this.dragHandlesContainer&&(f.events.pointerDown.forEach(function(e,t){var i;null!==(i=n.dragHandlesContainer)&&void 0!==i&&i.removeEventListener(e,n.onPointerDownRef,!1)}),null!==(e=null===(e=this.dragHandlesContainer)||void 0===e?void 0:e.parentElement)&&void 0!==e&&e.removeChild(this.dragHandlesContainer))},b.prototype.getDragHandlers=function(){var e=null==this.dragHandlesContainer?null:this.dragHandlesContainer.querySelectorAll("."+f.classes.handle);return e?Array.prototype.slice.call(e).filter(function(e){return"DIV"===e.nodeName}):new Array},b.prototype.restoreColumnWidths=function(){var e,i;this.options.store&&(0===(e=b.generateTableId(this.table)).length||(i=this.options.store.get(e))&&(this.getResizableHeaders().forEach(function(e){var t=i.columns[b.generateColumnId(e)];void 0!==t&&b.setWidth(e,t)}),void 0!==i.table&&b.setWidth(this.table,i.table)))},b.prototype.checkTableWidth=function(){var e=this.wrapper.clientWidth,t=e-this.table.offsetWidth;if(!(t<=0)){var i=0,n=0,a=[];this.tableHeaders.forEach(function(e,t){e.hasAttribute(f.attributes.dataResizable)&&(e={el:e,detail:e.offsetWidth},a.push(e),i+=e.detail)});for(var s,o,r,l=0,h=null;s=a.shift();){var l=t-n,h=s.el,d=Math.floor(s.detail/i*t),d=Math.min(d,l);if(t<=(n+=this.updateWidth(s.el,s.detail+d,!1,!0)-s.detail))break}0<(l=t-n)&&(r=(o=(null===(r=a[0])||void 0===r?void 0:r.el)||h||this.tableHeaders[this.tableHeaders.length-1]).offsetWidth,this.updateWidth(o,r,!0,!0)),b.setWidth(this.table,e)}},b.prototype.syncHandleWidths=function(){var a=this,e=this.table.clientWidth;b.setWidth(this.dragHandlesContainer,e),this.dragHandlesContainer.style.minWidth=e+"px";var s=this.getResizableHeaders();this.getDragHandlers().forEach(function(e,t){var i,n=(a.options.resizeFromBody?a.table:a.table.tHead).clientHeight;t<s.length&&(t=(i=s[t]).offsetWidth,t+=b.getOffset(i).left,t-=b.getOffset(a.dragHandlesContainer).left,e.style.left=t+"px",e.style.height=n+"px")})},b.prototype.getResizableHeaders=function(){return this.tableHeaders.filter(function(e,t){return e.hasAttribute(f.attributes.dataResizable)})},b.prototype.handlePointerDown=function(e){this.handlePointerUp();var t,i,n,a,s,o,r=e?e.target:null;null!=r&&"DIV"===r.nodeName&&r.classList.contains(f.classes.handle)&&("number"==typeof e.button&&0!==e.button||(t=r,(o=this.getDragHandlers().indexOf(t))>=(s=this.getResizableHeaders()).length||(n=(i=(new Date).getTime())-this.lastPointerDown<this.options.doubleClickDelay,s={column:r=(a=s[o]).offsetWidth,table:this.table.offsetWidth},(o=new l(a,t)).pointer={x:b.getPointerX(e),isDoubleClick:n},o.originalWidths=s,o.newWidths=s,this.detachHandlers(),this.attachHandlers(),this.table.classList.add(f.classes.tableResizing),this.wrapper.classList.add(f.classes.tableResizing),t.classList.add(f.classes.columnResizing),a.classList.add(f.classes.columnResizing),this.lastPointerDown=i,this.eventData=o,r=new CustomEvent(f.events.eventResizeStart,{detail:{column:a,columnWidth:r,table:this.table,tableWidth:this.table.clientWidth}}),this.table.dispatchEvent(r),e.preventDefault())))},b.prototype.handlePointerMove=function(e){var t;this.eventData&&e&&(0!=(t=(b.getPointerX(e)||0)-(this.eventData.pointer.x||0))&&(e=this.eventData.originalWidths.table+t,t=this.constrainWidth(this.eventData.column,this.eventData.originalWidths.column+t),b.setWidth(this.table,e),b.setWidth(this.eventData.column,t),this.eventData.newWidths={column:t,table:e},e=new CustomEvent(f.events.eventResize,{detail:{column:this.eventData.column,columnWidth:t,table:this.table,tableWidth:e}}),this.table.dispatchEvent(e)))},b.prototype.handlePointerUp=function(){var e;this.detachHandlers(),this.eventData&&(this.eventData.pointer.isDoubleClick&&this.handleDoubleClick(),this.table.classList.remove(f.classes.tableResizing),this.wrapper.classList.remove(f.classes.tableResizing),this.eventData.dragHandler.classList.remove(f.classes.columnResizing),this.eventData.column.classList.remove(f.classes.columnResizing),this.checkTableWidth(),this.syncHandleWidths(),this.refreshWrapperStyle(),this.saveColumnWidths(),e=this.eventData.newWidths||this.eventData.originalWidths,e=new CustomEvent(f.events.eventResizeStop,{detail:{column:this.eventData.column,columnWidth:e.column,table:this.table,tableWidth:e.table}}),this.table.dispatchEvent(e),this.eventData=null)},b.prototype.handleDoubleClick=function(){if(this.eventData&&this.eventData.column){var e=this.eventData.column,t=this.tableHeaders.indexOf(e),i=0,n=[];this.tableHeaders.forEach(function(e,t){e.hasAttribute(f.attributes.dataResizable)||n.push(t)});var a=this.ownerDocument.createElement("span");a.style.position="absolute",a.style.left="-99999px",a.style.top="-99999px",a.style.visibility="hidden",this.ownerDocument.body.appendChild(a);for(var s=this.table.querySelectorAll("tr"),o=0;o<s.length;o++)for(var r=s[o].querySelectorAll("td, th"),l=0,h=0;h<r.length;h++){var d,u=r[h],c=1;if(u.hasAttribute("colspan")&&(d=u.getAttribute("colspan")||"1",d=parseInt(d),c=isNaN(d)?1:d),-1===n.indexOf(h)&&1===c&&l===t){i=Math.max(i,b.getTextWidth(u,a));break}l+=c}this.ownerDocument.body.removeChild(a);var p=i-e.offsetWidth;0!=p&&(e=this.eventData.originalWidths.table+p,p=this.constrainWidth(this.eventData.column,this.eventData.originalWidths.column+p),b.setWidth(this.table,e),b.setWidth(this.eventData.column,p),this.eventData.newWidths={column:p,table:e},e=new CustomEvent(f.events.eventResize,{detail:{column:this.eventData.column,columnWidth:p,table:this.table,tableWidth:e}}),this.table.dispatchEvent(e),this.checkTableWidth(),this.syncHandleWidths(),this.saveColumnWidths())}},b.prototype.attachHandlers=function(){var i=this;f.events.pointerMove.forEach(function(e,t){i.ownerDocument.addEventListener(e,i.onPointerMoveRef,!1)}),f.events.pointerUp.forEach(function(e,t){i.ownerDocument.addEventListener(e,i.onPointerUpRef,!1)})},b.prototype.detachHandlers=function(){var i=this;f.events.pointerMove.forEach(function(e,t){i.ownerDocument.removeEventListener(e,i.onPointerMoveRef,!1)}),f.events.pointerUp.forEach(function(e,t){i.ownerDocument.removeEventListener(e,i.onPointerUpRef,!1)})},b.prototype.refreshWrapperStyle=function(){var e;null!=this.wrapper&&(e=this.wrapper.style.overflowX,this.wrapper.style.overflowX="hidden",this.wrapper.style.overflowX=e)},b.prototype.saveColumnWidths=function(){var e,t;!this.options.store||0!==(e=b.generateTableId(this.table)).length&&(t={table:this.table.offsetWidth,columns:{}},this.getResizableHeaders().forEach(function(e){t.columns[b.generateColumnId(e)]=e.offsetWidth}),this.options.store.set(e,t))},b.prototype.createHandlerReferences=function(){var t=this;this.onPointerDownRef||(this.onPointerDownRef=b.debounce(function(e){t.handlePointerDown(e)},100,!0)),this.onPointerMoveRef||(this.onPointerMoveRef=b.debounce(function(e){t.handlePointerMove(e)},5,!1)),this.onPointerUpRef||(this.onPointerUpRef=b.debounce(function(e){t.handlePointerUp()},100,!0))},b.prototype.registerWindowResizeHandler=function(){var i=this.ownerDocument.defaultView;b.windowResizeHandlerRef||(b.windowResizeHandlerRef=b.debounce(b.onWindowResize,50,!1),f.events.windowResize.forEach(function(e,t){null!=i&&i.addEventListener(e,b.windowResizeHandlerRef,!1)}))},b.prototype.handleWindowResize=function(){this.checkTableWidth(),this.syncHandleWidths(),this.saveColumnWidths()},b.prototype.updateWidth=function(e,t,i,n){var a=e.offsetWidth,t=i?t:this.constrainWidth(e,t);return b.setWidth(e,t),n||(a=this.table.offsetWidth+(t-a),b.setWidth(this.table,a)),t},b.onWindowResize=function(e){e=e?e.target:null;if(null!=e)for(var t=e.document.querySelectorAll("."+f.classes.table),i=0;i<t.length;i++){var n=t[i];"object"==typeof n[f.dataPropertyName]&&n[f.dataPropertyName].handleWindowResize()}},b.generateColumnId=function(e){return(e.getAttribute(f.attributes.dataResizable)||"").trim().replace(/\./g,"_")},b.generateTableId=function(e){e=(e.getAttribute(f.attributes.dataResizableTable)||"").trim().replace(/\./g,"_");return e.length?"rtc/"+e:e},b.setWidth=function(e,t){var i=t.toFixed(2),i=0<t?i:"0";e.style.width=i+"px"},b.getInstanceId=function(){return b.instancesCount++},b.getPointerX=function(e){if(0===e.type.indexOf("touch")){if(e.touches&&e.touches.length)return e.touches[0].pageX;if(e.changedTouches&&e.changedTouches.length)return e.changedTouches[0].pageX}return e.pageX},b.getTextWidth=function(e,t){var i;if(!e||!t)return 0;var n=(null===(i=e.textContent)||void 0===i?void 0:i.trim().replace(/\s/g,"&nbsp;"))+"&nbsp;",a=null===(i=e.ownerDocument.defaultView)||void 0===i?void 0:i.getComputedStyle(e);return["fontFamily","fontSize","fontWeight","padding","border","boxSizing"].forEach(function(e){t.style[e]=a[e]}),t.innerHTML=n,t.offsetWidth},b.getOffset=function(e){if(!e)return{top:0,left:0};var t=e.getBoundingClientRect();return{top:t.top+e.ownerDocument.body.scrollTop,left:t.left+e.ownerDocument.body.scrollLeft}},b.instancesCount=0,b.windowResizeHandlerRef=null,b.debounce=function(n,a,s){var o=null;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=s&&!o;o&&clearTimeout(o),o=setTimeout(function(){o=null,s||n.apply(void 0,e)},a),i&&n.apply(void 0,e)}},b);function b(e,t){if("object"!=typeof e||null===e||"[object HTMLTableElement]"!==e.toString())throw'Invalid argument: "table".\nResizableTableColumns requires that the table element is a not null HTMLTableElement object!';if(void 0!==e[f.dataPropertyName])throw'Existing "'+f.dataPropertyName+"\" property.\nTable element already has a '"+f.dataPropertyName+"' attached object!";this.id=b.getInstanceId(),this.table=e,this.options=new h(t,e),this.wrapper=null,this.ownerDocument=e.ownerDocument,this.tableHeaders=[],this.dragHandlesContainer=null,this.originalWidths=[],this.eventData=null,this.lastPointerDown=0,this.init(),this.table[f.dataPropertyName]=this}e.PointerData=n,e.ResizableConstants=f,e.ResizableEventData=l,e.ResizableOptions=h,e.ResizableTableColumns=u,e.Utilities=a,e.UtilitiesDOM=o,e.WidthsData=i,Object.defineProperty(e,"__esModule",{value:!0})});